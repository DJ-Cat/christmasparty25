<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Matti's Page</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap');

        body {
            margin: 0;
            overflow: hidden;
            background-image: url('sundown2.png'); 
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            font-family: 'Press Start 2P', cursive;
            color: white;
            user-select: none;
        }

        /* --- NEW PAGE HEADERS --- */
        #page-header {
            position: absolute;
            top: 30px;
            width: 100%;
            text-align: center;
            z-index: 20; /* Ensure it sits on top */
        }

        /* 8-bit 3D Text Effect */
        .main-3d-title {
            font-size: 48px;
            color: #FFD700; /* Bright Gold Face */
            margin: 0;
            /* Layered shadows to create the 3D block effect */
            text-shadow: 
                4px 4px 0px #c49600, /* Darker gold side */
                8px 8px 0px #8B4513, /* Brown depth */
                12px 12px 0px #000000; /* Black outline/shadow */
        }

        .sub-title-text {
            font-size: 16px;
            margin-top: 25px; /* Space from the top title */
            color: #fff;
            text-shadow: 3px 3px 0 #000; /* Simple retro outline */
        }


        /* --- THE FRAME & GAME --- */
        #game-container {
            position: relative;
            border: 12px solid #5D4037; 
            box-shadow: 
                inset 0 0 0 4px #DAA520,
                0 10px 20px rgba(0,0,0,0.8);
            border-radius: 4px;
            background-color: #000;
            /* Push it down slightly to balance with the new header */
            margin-top: 60px; 
        }

        canvas {
            display: block;
            image-rendering: pixelated; 
            background-color: #F4A460;
            cursor: crosshair;
        }

        #ui-layer {
            position: absolute;
            top: 14px;
            left: 14px;
            width: 610px;
            display: flex;
            justify-content: space-between;
            pointer-events: none;
            text-shadow: 2px 2px 0 #000;
            z-index: 5;
        }

        #start-screen {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.7);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 10;
            cursor: pointer;
            backdrop-filter: blur(2px);
        }

        h1.game-title { font-size: 24px; color: #ffcc00; text-shadow: 3px 3px 0 #8B4513; margin-bottom: 20px; }
        p.game-instr { font-size: 12px; line-height: 1.5; text-align: center; }
        .blink { animation: blinker 1s linear infinite; color: #00FF00; margin-top: 20px;}

        @keyframes blinker { 50% { opacity: 0; } }
    </style>
</head>
<body>

    <div id="page-header">
        <h1 class="main-3d-title">Matti's Page</h1>
        <p class="sub-title-text">Mathew's wild shoot out</p>
    </div>


    <div id="game-container">
        <canvas id="gameCanvas" width="640" height="360"></canvas>
        
        <div id="ui-layer">
            <div>SCORE: <span id="score">0</span></div>
            <div>LEVEL: <span id="level">1</span></div>
        </div>

        <div id="start-screen">
            <h1 class="game-title">HIGH NOON SHOOTER</h1>
            <p class="game-instr">The drinks are on the house,<br>but the gun is unsteady.</p>
            <p class="game-instr" style="color: #aaa; margin-top:10px;">(Crosshair moves faster as you score)</p>
            <div class="blink">[ CLICK TO START ]</div>
        </div>
    </div>

<script>
    const canvas = document.getElementById('gameCanvas');
    const ctx = canvas.getContext('2d');
    const scoreEl = document.getElementById('score');
    const levelEl = document.getElementById('level');
    const startScreen = document.getElementById('start-screen');

    // --- AUDIO ENGINE ---
    const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
    
    function playSound(type) {
        if (audioCtx.state === 'suspended') audioCtx.resume();
        const osc = audioCtx.createOscillator();
        const gainNode = audioCtx.createGain();
        osc.connect(gainNode);
        gainNode.connect(audioCtx.destination);
        const now = audioCtx.currentTime;

        if (type === 'shoot') {
            osc.type = 'sawtooth';
            osc.frequency.setValueAtTime(800, now);
            osc.frequency.exponentialRampToValueAtTime(100, now + 0.1);
            gainNode.gain.setValueAtTime(0.5, now);
            gainNode.gain.exponentialRampToValueAtTime(0.01, now + 0.1);
            osc.start(now); osc.stop(now + 0.1);
        } else if (type === 'hit') {
            osc.type = 'square';
            osc.frequency.setValueAtTime(1200, now);
            osc.frequency.exponentialRampToValueAtTime(800, now + 0.1);
            gainNode.gain.setValueAtTime(0.3, now);
            gainNode.gain.exponentialRampToValueAtTime(0.01, now + 0.3);
            osc.start(now); osc.stop(now + 0.3);
        } else if (type === 'spawn') {
            osc.type = 'triangle';
            osc.frequency.setValueAtTime(200, now);
            osc.frequency.linearRampToValueAtTime(600, now + 0.2);
            gainNode.gain.setValueAtTime(0.1, now);
            gainNode.gain.linearRampToValueAtTime(0, now + 0.2);
            osc.start(now); osc.stop(now + 0.2);
        }
    }

    // --- GAME STATE ---
    let gameActive = false;
    let score = 0;
    let difficultyMultiplier = 1;
    let cans = [];
    let particles = [];
    let lastTime = 0;
    
    const crosshair = { x: canvas.width / 2, y: canvas.height / 2, timer: 0 };
    const SHELF_Y = 250;
    const CAN_WIDTH = 24;
    const CAN_HEIGHT = 32;

    // --- INIT ---
    function startGame() {
        startScreen.style.display = 'none';
        gameActive = true;
        score = 0;
        difficultyMultiplier = 1;
        updateUI();
        spawnCans();
        lastTime = performance.now();
        requestAnimationFrame(gameLoop);
    }

    function spawnCans() {
        if(gameActive) playSound('spawn');
        for (let i = 0; i < 5; i++) {
            cans.push({
                x: 100 + (i * 100),
                y: SHELF_Y - CAN_HEIGHT,
                w: CAN_WIDTH, h: CAN_HEIGHT,
                color: Math.random() > 0.5 ? '#d93a3a' : '#3a6bd9',
                active: true
            });
        }
    }

    // --- INPUT ---
    function shoot() {
        if (!gameActive) return;
        playSound('shoot');
        let hit = false;
        cans.forEach(can => {
            if (!can.active) return;
            if (crosshair.x >= can.x && crosshair.x <= can.x + can.w && 
                crosshair.y >= can.y && crosshair.y <= can.y + can.h) {
                can.active = false; hit = true; score += 100;
                difficultyMultiplier = 1 + (Math.floor(score / 500) * 0.2);
                updateUI();
                createExplosion(can.x + can.w/2, can.y + can.h/2, can.color);
                playSound('hit');
            }
        });
        if (cans.filter(c => c.active).length === 0) setTimeout(spawnCans, 1000);
    }

    function updateUI() {
        scoreEl.innerText = score;
        let lvl = 1 + Math.floor(score / 500);
        levelEl.innerText = lvl;
        levelEl.style.color = lvl > 3 ? '#ff3333' : '#fff';
    }

    startScreen.addEventListener('click', () => { if(!gameActive) startGame(); });
    window.addEventListener('mousedown', () => { if(gameActive) shoot(); });
    window.addEventListener('keydown', (e) => {
        if (e.code === 'Space') {
            if(gameActive) shoot();
            else if (startScreen.style.display !== 'none') startGame();
        }
    });

    // --- LOGIC ---
    function update(dt) {
        if (!gameActive) return;
        crosshair.timer += dt * difficultyMultiplier;
        const wanderX = Math.sin(crosshair.timer * 0.0015) * (canvas.width / 2 - 50);
        const jitter = difficultyMultiplier > 2 ? Math.sin(crosshair.timer * 0.01) * 10 : 0;
        const wanderY = Math.cos(crosshair.timer * 0.0023) * 60;
        crosshair.x = (canvas.width / 2) + wanderX + jitter;
        crosshair.y = (SHELF_Y - 20) + wanderY;

        for (let i = particles.length - 1; i >= 0; i--) {
            let p = particles[i];
            p.x += p.vx; p.y += p.vy; p.life -= dt; p.vy += 0.01 * dt;
            if (p.life <= 0) particles.splice(i, 1);
        }
    }

    function createExplosion(x, y, color) {
        for (let i = 0; i < 20; i++) {
            particles.push({
                x: x, y: y,
                vx: (Math.random() - 0.5) * 0.8, vy: (Math.random() - 1) * 0.8,
                life: 500 + Math.random() * 500, color: color, size: Math.random() * 4 + 2
            });
        }
    }

    // --- DRAWING ---
    function draw() {
        ctx.fillStyle = '#8A4B7A'; 
        ctx.fillRect(0, 0, canvas.width, 100);
        ctx.fillStyle = '#D96D43'; 
        ctx.fillRect(0, 100, canvas.width, 80);
        ctx.fillStyle = '#F4A460'; 
        ctx.fillRect(0, 180, canvas.width, SHELF_Y - 180);

        ctx.fillStyle = '#F7C66D'; 
        ctx.fillRect(445, 45, 70, 70);
        ctx.fillStyle = '#ffcc00'; 
        ctx.fillRect(450, 50, 60, 60);

        ctx.fillStyle = '#5D4037';
        drawMesa(50, 200, 100);
        drawMesa(400, 250, 120);

        ctx.fillStyle = '#8D6E63'; 
        drawMesa(-50, 180, 80);
        drawMesa(250, 300, 60);
        drawMesa(550, 150, 90);

        drawCactus(150, SHELF_Y);
        drawCactus(500, SHELF_Y);
        drawCactus(50, SHELF_Y + 10, 0.8);

        ctx.fillStyle = '#654321'; 
        ctx.fillRect(0, SHELF_Y, canvas.width, 20);
        ctx.fillStyle = '#4e342e';
        for(let i=0; i<canvas.width; i+=20) ctx.fillRect(i + (Math.random()*10), SHELF_Y+5, 4, 4);
        
        ctx.fillStyle = '#4e342e'; 
        ctx.fillRect(0, SHELF_Y + 20, canvas.width, 110);

        cans.forEach(can => { if (can.active) drawCan(can); });
        particles.forEach(p => {
            ctx.fillStyle = p.color; ctx.fillRect(p.x, p.y, p.size, p.size);
        });
        if (gameActive) drawCrosshair(crosshair.x, crosshair.y);
    }

    function drawMesa(x, width, height) {
        const horizon = SHELF_Y;
        ctx.fillRect(x, horizon - height, width, height);
        const stepSize = 8;
        ctx.fillRect(x - stepSize, horizon - height + stepSize, stepSize, height - stepSize);
        ctx.fillRect(x + width, horizon - height + stepSize, stepSize, height - stepSize);
    }

    function drawCactus(x, y, scale = 1) {
        ctx.fillStyle = '#388E3C'; 
        const w = 12 * scale;
        const h = 50 * scale;
        ctx.fillRect(x, y - h, w, h);
        ctx.fillRect(x - w, y - (h*0.6), w, 4*scale);
        ctx.fillRect(x - w, y - (h*0.8), 4*scale, (h*0.2)+4*scale);
        ctx.fillRect(x + w, y - (h*0.5), w, 4*scale);
        ctx.fillRect(x + w + (4*scale), y - (h*0.7), 4*scale, (h*0.2)+4*scale);
    }

    function drawCan(can) {
        ctx.fillStyle = can.color; ctx.fillRect(can.x, can.y, can.w, can.h);
        ctx.fillStyle = 'rgba(255,255,255,0.4)'; ctx.fillRect(can.x + 4, can.y, 4, can.h);
        ctx.fillStyle = '#bdc3c7';
        ctx.fillRect(can.x, can.y, can.w, 4); ctx.fillRect(can.x, can.y + can.h - 4, can.w, 4);
    }

    function drawCrosshair(x, y) {
        ctx.strokeStyle = difficultyMultiplier > 2.5 ? '#FF0000' : '#00FF00';
        ctx.lineWidth = 4;
        const size = 20;
        ctx.strokeRect(x - size/2, y - size/2, size, size);
        ctx.beginPath();
        ctx.moveTo(x, y - size); ctx.lineTo(x, y - size - 10);
        ctx.moveTo(x, y + size); ctx.lineTo(x, y + size + 10);
        ctx.moveTo(x - size, y); ctx.lineTo(x - size - 10, y);
        ctx.moveTo(x + size, y); ctx.lineTo(x + size + 10, y);
        ctx.stroke();
        ctx.fillStyle = 'red'; ctx.fillRect(x - 2, y - 2, 4, 4);
    }

    function gameLoop(timestamp) {
        const dt = timestamp - lastTime;
        lastTime = timestamp;
        update(dt);
        draw();
        if(gameActive) requestAnimationFrame(gameLoop);
    }

    draw();
</script>
</body>
</html>